<?xml version="1.0"?>

<precice-configuration>

  <data:scalar name="I" waveform-degree="5" />
  <data:scalar name="U" waveform-degree="5" />

  <mesh name="MeshI" dimensions="2">
    <use-data name="I" />
    <use-data name="U" />
  </mesh>

  <mesh name="MeshU" dimensions="2">
    <use-data name="U" />
    <use-data name="I" />
  </mesh>

  <participant name="ParticipantI">
    <provide-mesh name="MeshI" />
    <receive-mesh name="MeshU" from="ParticipantU"/>
    <write-data name="I"     mesh="MeshI" />
    <read-data  name="U" mesh="MeshI" />
    <mapping:nearest-neighbor
      direction="write" from="MeshI" to="MeshU" constraint="consistent"/>
    <mapping:nearest-neighbor
      direction="read" from="MeshU" to="MeshI" constraint="consistent"/>
  </participant>

  <participant name="ParticipantU">
    <provide-mesh name="MeshU" />
    <receive-mesh name="MeshI" from="ParticipantI"/>
    <write-data name="U"     mesh="MeshU" />
    <read-data  name="I" mesh="MeshU" />
    <mapping:nearest-neighbor
      direction="write" from="MeshU" to="MeshI" constraint="consistent"/>
    <mapping:nearest-neighbor
      direction="read" from="MeshI" to="MeshU" constraint="consistent"/>
    <watch-point mesh="MeshU" name="UI" coordinate="0.0;0.0" />
  </participant>

  <m2n:sockets acceptor="ParticipantI" connector="ParticipantU" exchange-directory=".." />

  <coupling-scheme:serial-implicit>
    <participants first="ParticipantI" second="ParticipantU" />
    <max-time value="10" />
    <time-window-size value=".1" />
    <max-iterations value="20" />
    <exchange data="I" mesh="MeshI" from="ParticipantI" to="ParticipantU" substeps="true" />
    <exchange data="U" mesh="MeshU" from="ParticipantU" to="ParticipantI" substeps="true" />
    <relative-convergence-measure limit="1e-8" data="U" mesh="MeshU" />
    <relative-convergence-measure limit="1e-8" data="I" mesh="MeshI" />
  </coupling-scheme:serial-implicit>
</precice-configuration>
